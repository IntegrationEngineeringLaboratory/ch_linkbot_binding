# Makefile to build liblinkbot.dl in Windows

BOOST_LIBS=$(BOOST_ROOT)/stage/lib

HEADERS=../include/barobo \
C:/Ch/extern/include

target: liblinkbot.dl

LFLAG= C:/ch/extern/lib/chsdk.lib C:/ch/extern/lib/ch.lib
#C:/ch/bin/ch.dll 	

LINKLIBS=../build_msvc/release/linkbot.lib \
../build_msvc/baromesh/library/Release/baromesh.lib  \
../build_msvc/baromesh/library/libsfp/Release/sfp.lib \
../build_msvc/baromesh/library/ribbon-bridge/Release/rpc.lib \
../build_msvc/baromesh/library/ribbon-bridge/Release/rpc-proto.lib \
../build_msvc/baromesh/library/baromesh/interfaces/Release/robot-interface.lib \
../build_msvc/baromesh/library/baromesh/interfaces/Release/daemon-interface.lib \
../build_msvc/baromesh/library/baromesh/interfaces/Release/dongle-interface.lib \
../build_msvc/baromesh/library/baromesh/interfaces/Release/commontypes-proto.lib \
../build_msvc/baromesh/library/baromesh/common/Release/baromesh-common.lib \
../build_msvc/baromesh/library/cxx-util/Release/cxx-util.lib \
../../deps/boost_1_57_0/stage/lib/libboost_filesystem-vc120-mt-1_57.lib \
../../deps/boost_1_57_0/stage/lib/libboost_system-vc120-mt-1_57.lib \
../../deps/boost_1_57_0/stage/lib/libboost_log-vc120-mt-1_57.lib \
../../deps/boost_1_57_0/stage/lib/libboost_thread-vc120-mt-1_57.lib \
../build_msvc/release/linkbot.lib \
ws2_32.lib\
shell32.lib

liblinkbot.dl: chlinkboti_chdl.obj chlinkbotl_chdl.obj
	ch dllink liblinkbot.dl cplusplus chlinkboti_chdl.obj chlinkbotl_chdl.obj $(LINKLIBS) $(LFLAG) 

chlinkboti_chdl.obj: chlinkboti_chdl.cpp $(HEADERS)
	ch dlcomp liblinkbot.dl cplusplus chlinkboti_chdl.cpp 

chlinkbotl_chdl.obj: chlinkbotl_chdl.cpp $(HEADERS)
	ch dlcomp liblinkbot.dl cplusplus chlinkbotl_chdl.cpp 


clean:
	del *.obj *.dl

install:
	sh ./createpkg.sh
	ch pkginstall.ch chbarobo-0.2
